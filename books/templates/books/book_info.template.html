{% extends 'base.template.html' %}
{% load static %}
{% load cloudinary %}
{% load mathfilters %}
{% load crispy_forms_tags %}

{%block title%}RPG Books{%endblock%}

{%block css%}
<style>
.carousel-indicators .active{
    background-color: red;
}

.carousel-indicators li,
.modal-content{
    background-color: rgba(25,25,25,1);
}

.desc_text h6{
    font-size: 1rem;
    text-align: center;
    background: rgba(25,25,25,1);
    border: 1px solid rgba(150,150,150,1.0);
    color: antiquewhite;
    letter-spacing: 0.2rem;
    font-family: 'MedievalSharp', cursive;
    font-weight: bold;
}

.desc_text{
    font-size: 0.8rem;
    text-align: center;
    background: rgba(25,25,25,0.8);
    border: 1px solid rgba(150,150,150,1.0);
    color: antiquewhite;
    letter-spacing: 0.1rem;
}

.preview_item:hover {
    transform: scale(1.1);
}

.price_cart,
.tech_details,
.reviews_wrapper {
    border: 1px solid rgba(150,150,150,1.0);
    background: rgba(25,25,25,0.8);
}

.item_price,
.modal-header span {
    font-family: 'MedievalSharp', cursive;
    color: antiquewhite;
    letter-spacing: 0.2rem;
    font-size: 1.2rem;
    font-weight: bolder;
}

.vats {
    font-family: 'El Messiri', sans-serif;
    color: antiquewhite;
    letter-spacing: 0.2rem;
    font-size: 0.6rem;
}

.tech_details h6,
.review_title h6 {
    font-family: 'MedievalSharp', cursive;
    color: antiquewhite;
    letter-spacing: 0.2rem;
    font-size: 1rem;
    font-weight: bold;
    border-bottom: 1px solid rgba(150,150,150,1.0);
}

.tech_details_label,
.ratings_reviews h6 {
    font-family: 'MedievalSharp', cursive;
    color: antiquewhite;
    letter-spacing: 0.2rem;
    font-size: 0.8rem;
    font-weight: 500;
    text-align: left;
}

.tech_details_info {
    font-family: 'El Messiri', sans-serif;
    color: antiquewhite;
    letter-spacing: 0.1rem;
    font-size: 0.8rem;
    text-align: right;
}

.ratings_reviews {
    font-family: 'El Messiri', sans-serif;
    color: antiquewhite;
    letter-spacing: 0.2rem;
    font-size: 0.8rem;
    text-align: left;
}

.post_review,
.edit_book{
    font-family: 'El Messiri', sans-serif;
    letter-spacing: 0.2rem;
    font-size: 0.6rem;
}

</style>
{%endblock%}

{%block js%}{%endblock%}

{%block content%}
{% comment %} <div class="container">
    <form method="POST">
        {% csrf_token %}
        {{form|crispy}}
    </form>
</div> {% endcomment %}

<div class="container d-flex justify-content-around">
    <div class="column1 col-6 d-flex flex-column justify-content-center text-center mt-4">
        <div class="book_cover">
            {% cloudinary book.cover width=200 height=300 crop="fill" %}
        </div>
        <div class="book_description my-3 d-flex flex-column justify-content-center align-items-center">
            <div id="carouselExampleIndicators" class="carousel slide col-8" data-ride="carousel">
                <ol class="carousel-indicators mt-1 mb-0">
                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item preview_item active">
                        <div class="d-block w-100 ">{% cloudinary book.preview_1 width=80 height=120 crop="fill" %}</div>
                    </div>
                    <div class="carousel-item preview_item">
                        <div class="d-block w-100 ">{% cloudinary book.preview_2 width=80 height=120 crop="fill" %}</div>
                    </div>
                    <div class="carousel-item preview_item">
                        <div class="d-block w-100 ">{% cloudinary book.preview_3 width=80 height=120 crop="fill" %}</div>
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <div class="desc_text mt-4">
                <h6>Description</h6>
                <p class="p-2">{{book.description}}</p>
            </div>
        </div>
    </div>
    <div class="column2 col-6 d-flex flex-column justify-content-center text-center">
        <div class="price_cart d-flex py-3">
            <div class="col-6">
                <div class="item_price">USD {{book.price|div:100}}</div>
                <div class="vats">VATS may apply</div>
            </div>
            <div class="col-6">
                <div class="add_to_cart">
                    <a href="{% url 'add_to_cart' book_id=book.id %}" class="btn btn-lg btn-success"><i class="fas fa-shopping-cart"></i>  Add to Cart</a>
                </div>
            </div>
        </div>
        <div class="tech_details d-flex flex-column justify-content-around align-items-center py-3 my-1">
            <div class="px-2 mb-2 d-flex justify-content-between align-items-center">
                <h6 class="text-left">TECHNICAL DETAILS</h6>
                {% if user.is_authenticated %}
                    <button type="button" class="btn btn-outline-info btn-sm edit_book ml-5">Edit book</button>
                {%endif%}
            </div>
            <div class="d-flex">
                <div class="d-flex flex-column tech_details_label">
                    Title:<br/>
                    ISBN:<br/>
                    Series:<br/>
                    Release Date:<br/>
                    Genre:<br/>
                    Tags:<br/>
                </div>
                <div class="d-flex flex-column tech_details_info">
                    {{book.title}}<br/>
                    {{book.ISBN}}<br/>
                    {{book.category}}<br/>
                    {{book.release_date}}<br/>
                    {{book.genre}}<br/>
                    {{book.tags}}<br/>
                </div>
            </div>
        </div>
        <div class="ratings_reviews mt-4 d-flex flex-column">
            <div class="d-flex justify-content-between">
                <h6 class="text-left">See what others are say...</h6>
                <button type="button" class="btn btn-outline-info btn-sm post_review" data-toggle="modal" data-target="#new_review">Post Review</button>

                <!--New Review Post Modal-->
                <div class="modal fade" id="new_review" aria-labelledby="new_review_label" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="new_review_label">Post a New Review</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form method="POST">
                                    {% csrf_token %}
                                    {{review_form|crispy}}
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                <input type="submit" class="btn btn-primary" value="Post New Review">
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="reviews_wrapper mt-2 overflow-auto" style="height:300px;">
                {% for review in reviews %}
                <div>   
                    <div class="review_title d-flex justify-content-between px-2 pt-2">
                        <h6>{{review.user}}</h6>
                        <h6>{{review.date}}</h6>
                    </div>
                    <div class="review_content d-flex justify-content-center align-items-center"> 
                        <p class="px-2 pt-1">{{review.content}} --- {{review.rating}} out of 5<p>
                    </div>
                </div>
                {%endfor%}
            </div>
        </div>
    </div>
</div>



{%endblock%}